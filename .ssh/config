# --- Global Defaults ---

Host *
    # Why: Replaces legacy 'Protocol 2' (now the default) with modern security.
    UseRoaming no

    # Why: Native macOS integration for passphrases.
    AddKeysToAgent yes
    UseKeychain yes

    # Why: Improve reliability on long-lived connections (AWS/Tunnels).
    ServerAliveInterval 60
    ServerAliveCountMax 3

    # Why: Speed up subsequent connections (Git/AWS) by reusing the socket.
    ControlMaster auto
    ControlPath ~/.ssh/control/%C
    ControlPersist 10m

    # Why: Keep your specific timeout but disable slow GSSAPI lookups.
    ConnectTimeout 5
    GSSAPIAuthentication no
    Compression yes


# --- Specific Hosts ---

Host github.com
    User git
    IdentityFile ~/.ssh/id_ed25519
    IdentitiesOnly yes

Host *.amazonaws.com
    User ec2-user
    # Why: Maintain your existing automation for connection feedback.
    PermitLocalCommand yes
    LocalCommand echo "Connected to %r@%h"

Host vnctunnel
    # Why: Automate VNC client launch upon tunnel establishment.
    PermitLocalCommand yes
    LocalCommand open vnc://localhost
    LocalForward 5900 localhost:5900
